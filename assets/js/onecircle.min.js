var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(a){return a.raw=a};$jscomp.createTemplateTagFirstArgWithRaw=function(a,c){a.raw=c;return a};$jscomp.findInternal=function(a,c,b){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(c.call(b,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;
$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){if(a==Array.prototype||a==Object.prototype)return a;a[c]=b.value;return a};
$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var c=0;c<a.length;++c){var b=a[c];if(b&&b.Math==Math)return b}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};
$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,c){var b=$jscomp.propertyToPolyfillSymbol[c];if(null==b)return a[c];b=a[b];return void 0!==b?b:a[c]};$jscomp.polyfill=function(a,c,b,d){c&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,c,b,d):$jscomp.polyfillUnisolated(a,c,b,d))};
$jscomp.polyfillUnisolated=function(a,c,b,d){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];if(!(e in b))return;b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})};
$jscomp.polyfillIsolated=function(a,c,b,d){var e=a.split(".");a=1===e.length;d=e[0];d=!a&&d in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var f=0;f<e.length-1;f++){var g=e[f];if(!(g in d))return;d=d[g]}e=e[e.length-1];b=$jscomp.IS_SYMBOL_NATIVE&&"es6"===b?d[e]:null;c=c(b);null!=c&&(a?$jscomp.defineProperty($jscomp.polyfills,e,{configurable:!0,writable:!0,value:c}):c!==b&&($jscomp.propertyToPolyfillSymbol[e]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(e):$jscomp.POLYFILL_PREFIX+e,e=
$jscomp.propertyToPolyfillSymbol[e],$jscomp.defineProperty(d,e,{configurable:!0,writable:!0,value:c})))};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(c,b){return $jscomp.findInternal(this,c,b).v}},"es6","es3");console.log(" %c Theme onecircle %c https://github.com/gogobody/onecircle","color:#444;background:#eee;padding:5px 0","color:#eee;background:#444;padding:5px");
var stripscript=function(a){for(var c=/[`^()|{}'\[\].<>/?~\uff01\u2026\u2026*\u2014\u2014|{}\u2018\u201d\u201c\u21b5\r\n]/,b="",d=0;d<a.length;d++)b+=a.substr(d,1).replace(c,"");return b};function toArray(a){var c=[],b;for(b in a)a.hasOwnProperty(b)&&c.push(a[b]);return c}
$(function(){$('[data-toggle="tooltip"]').tooltip();$.extend({message:function(a){var c={title:"",message:" \u64cd\u4f5c\u6210\u529f",time:"3000",type:"success",showClose:!0,autoClose:!0,onClose:function(){}};"string"==typeof a&&(c.message=a);"object"==typeof a&&(c=$.extend({},c,a));var b;a='<div class="c-message animated animate__slideInRight"><i class=" c-message--icon c-message--'+c.type+'"></i><div class="el-notification__group">'+(""!==c.title?'<h2 class="c-message__title">'+c.title+"</h2>":
"")+'<div class="el-notification__content">'+c.message+"</div>"+(c.showClose?'<div class="c-message--close">\u00d7</div>':"")+"</div></div>";var d=$("body"),e=$(a);var f=function(){e.addClass("animate__slideOutRight");e.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){g()})};var g=function(){e.remove();c.onClose(c);clearTimeout(b)};$(".c-message").remove();d.append(e);e.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",
function(){e.removeClass("messageFadeInDown")});d.on("click",".c-message--close",function(h){f()});c.autoClose&&(b=setTimeout(function(){f()},c.time))},showloading:function(a){a=$.extend({},{selector:"header",choice:"append"},a);if("string"===typeof a.selector){var c=$(a.selector);"append"===a.choice?c.append('<div class="loading-container"><svg width="120" height="12px" viewBox="0 0 120 30" xmlns="http://www.w3.org/2000/svg" fill="#03A9F5" class="loading-svg"><circle cx="15" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="60" cy="15" r="9" fill-opacity="0.3"><animate attributeName="r" from="9" to="9" begin="0s" dur="0.8s" values="9;15;9" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from="0.5" to="0.5" begin="0s" dur="0.8s" values=".5;1;.5" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="105" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite"></animate></circle></svg></div>'):
"prepend"===a.choice?c.prepend('<div class="loading-container"><svg width="120" height="12px" viewBox="0 0 120 30" xmlns="http://www.w3.org/2000/svg" fill="#03A9F5" class="loading-svg"><circle cx="15" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="60" cy="15" r="9" fill-opacity="0.3"><animate attributeName="r" from="9" to="9" begin="0s" dur="0.8s" values="9;15;9" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from="0.5" to="0.5" begin="0s" dur="0.8s" values=".5;1;.5" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="105" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite"></animate></circle></svg></div>'):
"after"===a.choice?c.after('<div class="loading-container"><svg width="120" height="12px" viewBox="0 0 120 30" xmlns="http://www.w3.org/2000/svg" fill="#03A9F5" class="loading-svg"><circle cx="15" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="60" cy="15" r="9" fill-opacity="0.3"><animate attributeName="r" from="9" to="9" begin="0s" dur="0.8s" values="9;15;9" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from="0.5" to="0.5" begin="0s" dur="0.8s" values=".5;1;.5" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="105" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite"></animate></circle></svg></div>'):
"before"===a.choice&&c.before('<div class="loading-container"><svg width="120" height="12px" viewBox="0 0 120 30" xmlns="http://www.w3.org/2000/svg" fill="#03A9F5" class="loading-svg"><circle cx="15" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="60" cy="15" r="9" fill-opacity="0.3"><animate attributeName="r" from="9" to="9" begin="0s" dur="0.8s" values="9;15;9" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from="0.5" to="0.5" begin="0s" dur="0.8s" values=".5;1;.5" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="105" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite"></animate></circle></svg></div>')}},
rmloading:function(){$(".loading-container").remove()}})});
var indexInput={init:function(){this.loginUserName="";this.addArea=$(".add-area");this.addAreaBtn=$(".add-area button");this.addPicBtn=$("#addpic");this.addLinkBtn=$("#addlink");this.addVideoBtn=$("#addvideo");this.addBilibiliBtn=$("#addbilibili");this.uploadPic=$(".upload-pic");this.showPanel=$(".show-panel.fbjukw");this.additionArray=[];this.nowtype="default";this.articleType=$("#articleType");this.funcInit()},funcInit:function(){this.indexEventInit();this.login_ajax();this.searchEventInit();this.articleClickInit();
this.asideEventInit();this.messagePageInit();this.userCenterInit()},resetInputStatus:function(){this.additionArray=[]},changeType:function(a){this.nowtype!==a&&(this.nowtype=a,this.articleType.val(a),this.resetInputStatus(),$(".add-area input").val(""))},doParseDefaultFunc:function(a,c){$(a).html("\u89e3\u6790\u4e2d");var b=$(".add-area input"),d=b.val();checkURL(d)?(c.showPanel.append('<div class="sc-AxjAm sc-AxirZ ciIrlj">\n<div class="eHTuZC" style="background-image: url('+d+');">\n<div class="cPHQWG">\n<svg viewBox="0 0 17 17" fill="currentColor">\n<path d="M9.565 8.595l5.829 5.829a.686.686 0 01-.97.97l-5.83-5.83-5.828 5.83a.686.686 0 01-.97-.97l5.829-5.83-5.83-5.828a.686.686 0 11.97-.97l5.83 5.829 5.829-5.83a.686.686 0 01.97.97l-5.83 5.83z"></path>\n</svg>\n</div>\n</div>\n</div>'),
c.additionArray.push(d),c.addPicBtn.siblings().addClass("btn-disable"),b.val(""),$(".cPHQWG").unbind("click").bind("click",function(){var e=$(this).parent().css("backgroundImage").replace("url(","").replace(")","");c.additionArray.splice($.inArray(e,c.additionArray),1);$(this).parent().parent().remove();0===c.additionArray.length&&c.addPicBtn.siblings().removeClass("btn-disable")})):$.message({title:"\u63d0\u793a",message:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u56fe\u7247\u5730\u5740",type:"error"});
$(a).html("\u6dfb\u52a0")},doParseLinkFunc:function(a,c){$(a).text("\u89e3\u6790\u4e2d");var b=$(".add-area input").val();checkURL(b)?$.post(gconf.oneaction,{type:"parsemeta",url:b},function(d){if(d.code){var e=$(".sc-AxjAm.kgcKxQ");e.css("display","block");e.attr("href",b);$(".sc-AxjAm.kgcKxQ .hHnMup").html(d.data);c.additionArray=[];c.additionArray.push(b);c.additionArray.push(stripscript(d.data));$(a).text("\u6dfb\u52a0");c.addLinkBtn.siblings().addClass("btn-disable");$(".sc-AxjAm.sc-AxirZ.ezTcmd").unbind("click").bind("click",
function(f){$(".kgcKxQ").css("display","none");f.stopPropagation();c.addLinkBtn.siblings().removeClass("btn-disable");return!1})}else $.message({title:"\u63d0\u793a",message:"\u89e3\u6790\u5931\u8d25",type:"error"}),console.log(d);$(a).text("\u6dfb\u52a0")}):($.message({title:"\u63d0\u793a",message:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u5730\u5740",type:"error"}),$(a).text("\u6dfb\u52a0"))},doParseVideoFunc:function(a,c){a=$(".add-area input");var b=a.val();checkURL(b)?(c.additionArray.push(b),c.showPanel.append('<div class="show-panel-inner"><div class="jLaetV"><div class="hHnMup">'+
b+'</div></div>\n<div class="ezTcmd show-close">\n<div class="hyliOy">\n<svg viewBox="0 0 17 17" fill="#ccc">\n<path d="M9.565 8.595l5.829 5.829a.686.686 0 01-.97.97l-5.83-5.83-5.828 5.83a.686.686 0 01-.97-.97l5.829-5.83-5.83-5.828a.686.686 0 11.97-.97l5.83 5.829 5.829-5.83a.686.686 0 01.97.97l-5.83 5.83z"></path>\n</svg>\n</div>\n</div></div>'),c.addVideoBtn.siblings().addClass("btn-disable"),a.val(""),$(".show-close").unbind("click").bind("click",function(){var d=$(this).siblings().text();c.additionArray.splice($.inArray(d,
c.additionArray),1);$(this).parent().remove();0===c.additionArray.length&&c.addVideoBtn.siblings().removeClass("btn-disable")})):$.message({title:"\u63d0\u793a",message:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u89c6\u9891\u5730\u5740",type:"error"})},doParseBilibiliFunc:function(a,c){a=$(".add-area input");var b=a.val();c.additionArray.push(b);c.showPanel.append('<div class="show-panel-inner"><div class="jLaetV"><div class="hHnMup">'+b+'</div></div>\n<div class="ezTcmd show-close">\n<div class="hyliOy">\n<svg viewBox="0 0 17 17" fill="#ccc">\n<path d="M9.565 8.595l5.829 5.829a.686.686 0 01-.97.97l-5.83-5.83-5.828 5.83a.686.686 0 01-.97-.97l5.829-5.83-5.83-5.828a.686.686 0 11.97-.97l5.83 5.829 5.829-5.83a.686.686 0 01.97.97l-5.83 5.83z"></path>\n</svg>\n</div>\n</div></div>');
c.addBilibiliBtn.siblings().addClass("btn-disable");a.val("");$(".show-close").unbind("click").bind("click",function(){var d=$(this).siblings().text();c.additionArray.splice($.inArray(d,c.additionArray),1);$(this).parent().remove();0===c.additionArray.length&&c.addBilibiliBtn.siblings().removeClass("btn-disable")})},indexEventInit:function(){var a=this;$("#addpic").unbind("click").bind("click",function(){$(".add-area input").attr("placeholder","\u8bf7\u8f93\u5165\u56fe\u7247\u94fe\u63a5");"default"!==
a.nowtype?(a.addArea.show(),a.uploadPic.show()):(a.addArea.toggle(),a.uploadPic.toggle());a.changeType("default")});$("#addlink,#addvideo,#addbilibili").unbind("click").bind("click",function(){a.uploadPic.hide();var b=$(this).data("type");"link"===b?$(".add-area input").attr("placeholder","\u8bf7\u8f93\u5165\u94fe\u63a5"):"video"===b?$(".add-area input").attr("placeholder","\u8bf7\u8f93\u5165\u89c6\u9891\u94fe\u63a5"):"bilibili"===b&&$(".add-area input").attr("placeholder","\u8bf7\u8f93\u5165bv\u53f7");
a.nowtype!==b?a.addArea.show():a.addArea.toggle();a.changeType(b)});this.addAreaBtn.unbind("click").bind("click",function(){"default"===a.nowtype?a.doParseDefaultFunc(this,a):"link"===a.nowtype?a.doParseLinkFunc(this,a):"video"===a.nowtype?a.doParseVideoFunc(this,a):"bilibili"===a.nowtype&&a.doParseBilibiliFunc(this,a)});$("#text").bind("input propertychange",function(){var b=$(".pub.eynkqj");$(this).val()?b.removeAttr("disabled"):(b.attr("disabled",!0),b.css("background-color","rgb(255, 241, 147)"))});
$(".sc-AxjAm.bwpEWU.gsmhQy").bind("input propertychange",function(){var b=$(".sc-AxjAm.eVNRGW");$(this).val()?b.removeAttr("disabled"):b.attr("disabled",!0)});var c=$("#topic-search-downshift-input");c&&c.autoComplete({minChars:0,source:function(b,d){b=b.toLowerCase();for(var e=allCategories,f=[],g=0;g<e.length;g++)~e[g][0].toLowerCase().indexOf(b)&&f.push(e[g]);0===f.length&&f.push(["\u672a\u641c\u7d22\u5230\u7ed3\u679c",-1,"",""]);d(f)},renderItem:function(b,d){d=[];d[0]=b[0];d[1]=b[1];return-1===
b[1]?'<div class="autocomplete-suggestion" data-val="'+JSON.stringify(d).replace(/"/g,"'")+'" disabled><div class="sc-AxjAm oDrAC" disabled>'+b[0]+"</div></div>":'<div class="autocomplete-suggestion" data-val="'+JSON.stringify(d).replace(/"/g,"'")+'"><img src="'+b[2]+'" class="sc-AxjAm gLHjJQ"><div class="sc-AxjAm oDrAC">'+b[0]+"</div></div>"},onSelect:function(b,d,e){d=d.replace(/'/g,'"');b=JSON.parse(d);d=b[1];e=$("#category");-1===d?($("#topic-search-downshift-input").val(""),e.val(1)):(c.val(b[0]),
e.val(d))}});$(".post-content-inner-link a").click(function(b){b.stopPropagation()})},searchEventInit:function(){var a=$(".search-block-icon"),c=$("#search-block");a.unbind("click").bind("click",function(){"none"===c.css("display")?c.slideDown():$(".search-block").slideUp()});$(".close").unbind("click").bind("click",function(){$(".search-block").slideUp()})},login_ajax:function(){function a(){d.attr("disabled",!0).fadeTo("",1)}function c(){d.attr("disabled",!1).fadeTo("",1)}var b=this,d=$("#login-submit"),
e=$("#navbar-login-user"),f=$("#navbar-login-password");this.canLogin=!0;$("#Login_form").submit(function(){if(b.canLogin){b.canLogin=!1;var g=this;if($(this).hasClass("banLogin"))return location.reload(),!1;d.attr("disabled",!0).fadeTo("slow",.5);var h=e.val(),k=f.val();return""===h?(b.canLogin=!0,$.message({title:"\u767b\u5f55\u901a\u77e5",message:"\u5fc5\u987b\u586b\u5199\u7528\u6237\u540d",type:"warning"}),e.focus(),a(),!1):""===k?(b.canLogin=!0,$.message({title:"\u767b\u5f55\u901a\u77e5",message:"\u8bf7\u586b\u5199\u5bc6\u7801",
type:"warning"}),f.focus(),a(),!1):(d.addClass("active"),$("#spin-login").addClass("show inline"),$.post(gconf.oneaction,{type:"getsecurl",url:window.location.href},function(m){if(!m.code)return $.message({title:"\u63d0\u793a",message:"\u83b7\u53d6securl\u5931\u8d25",type:"error"});$("#Login_form").attr("action",m.data);$.ajax({url:m.data,type:$(g).attr("method"),data:$(g).serializeArray(),error:function(){b.canLogin=!0;return $.message({title:"\u767b\u5f55\u901a\u77e5",message:"\u63d0\u4ea4\u51fa\u9519",
type:"error"}),c()},success:function(l){l=$.parseHTML(l);d.removeClass("active");$("#spin-login").removeClass("show inline");try{if(0>=$("#Logged-in",l).length)return b.canLogin=!0,c(),$.message({title:"\u767b\u5f55\u901a\u77e5",message:"\u7528\u6237\u540d\u6216\u8005\u5bc6\u7801\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5",type:"error"});a();l=$("#easyLogin",l).html();$("#easyLogin").html(l);$.message({title:"\u767b\u5f55\u901a\u77e5",message:'\u767b\u5f55\u6210\u529f:&nbsp;<a onclick="location.reload();">\u70b9\u51fb\u8fd9\u91cc\u5237\u65b0\u9875\u9762\uff0c\u6216\u7b49\u5f85\u81ea\u52a8\u5237\u65b0</a>',
type:"success"});b.canLogin=!0;b.loginUserName=h;setTimeout(function(){location.reload()},500)}catch(n){alert("\u6309\u4e0bF12\uff0c\u67e5\u770b\u8f93\u51fa\u9519\u8bef\u4fe1\u606f"),b.canLogin=!0}}})}),!1)}})},loginBan:function(){var a=$("#Login_form");a.hasClass("banLogin")||(a.addClass("banLogin"),$("#navbar-login-user").attr("disabled","disabled"),$("#navbar-login-password").attr("disabled","disabled"))},resetLoginAction:function(a){0<userId||$.post(gconf.oneaction,{type:"getsecurl",url:window.location.href},
function(c){if(!c.code)return $.message({title:"\u63d0\u793a",message:"\u83b7\u53d6securl\u5931\u8d25",type:"error"});$("#Login_form").attr("action",c.data);a()})},articleClickInit:function(){$.support.pjax&&$("article[do-pjax]").unbind().bind("click",function(a){var c=$(this).data("url");"IMG"!==a.target.tagName&&$.pjax({url:c,container:"#pjax-container"})});$(".content-action").each(function(a,c){$(c).find(".btn-like").on("click",function(b){$(this).get(0).disabled=!0;$.ajax({url:$(this).data("link"),
type:"post",data:"agree="+$(this).attr("data-cid"),async:!0,timeout:3E4,cache:!1,success:function(d){/\d/.test(d)&&$($(".btn-like").find("span.agree-num")[a]).html(d)},error:function(){$(this).get(0).disabled=!1}});b.stopPropagation();return!1})})},asideEventInit:function(){var a=$(".aside-btn"),c=$("#aside"),b=$("footer");a.unbind("click").bind("click",function(){c.hasClass("off-screen")?(c.removeClass("off-screen"),b.show()):(c.addClass("off-screen"),b.hide())});$(".off-screen-toggle").unbind("click").bind("click",
function(){$("#aside").toggleClass("off-screen")});$("#aside .nav-menu").unbind("click").bind("click",function(){$("#aside").toggleClass("off-screen")})},messagePageInit:function(){var a=$("#contact-search");a&&a.autoComplete({minChars:1,source:function(b,d){b=b.toLowerCase();$.post(gconf.index,{getallfollowers:1,type:"getallfollowers",uid:userId,keyword:b},function(e){e=JSON.parse(e);var f=[];e.forEach(function(g,h){f.push(toArray(g))});d(f)})},renderItem:function(b,d){d=d.replace(/[-\/\\^$*+?.()|[\]{}]/g,
"\\$&");d=new RegExp("("+d.split(" ").join("|")+")","gi");return'<div class="autocomplete-suggestion" style="background: #fff" data-uid="'+b[0]+'"><img class="sc-AxjAm jZLHXc" src="'+b[4]+'">'+(b[3]?b[3]:b[1]).replace(d,"<b>$1</b>")+"</div>"},onSelect:function(b,d,e){b=e.data("uid");userMsg.buildChatBox(b)}});$("#contact-list ul.list-group.contact-list li").unbind("click").bind("click",function(b){if(b=$(this).data("uid"))userMsg.buildChatBox(b),b=$(this).children(".media-body p.font-bold"),b.text(b.text().replace("[\u672a\u8bfb]",
""))});var c=$("#sendUserMsg");$("#usermsg-input");c.unbind("click").bind("click",function(b){if(b=$("#chat-tab a").data("uid")){var d=$("#usermsg-input").val();d=d.trim();d=safe.stripscript(d);if(2>d.length)return $.message({title:"\u63d0\u793a",message:"\u8f93\u5165\u5b57\u7b26\u592a\u5c11",type:"info"});if(500<d.length)return $.message({title:"\u63d0\u793a",message:"\u8f93\u5165\u5b57\u7b26\u592a\u591a",type:"info"});c.text("\u53d1\u9001\u4e2d..");c.attr("disabled","true");var e=3;timer=setInterval(function(){0===
e?(clearInterval(timer),c.removeAttr("disabled"),c.text("\u53d1\u9001")):(c.text("\u8fd8\u5269"+e+"\u79d2"),e--)},1E3);userMsg.sendMsg(b,d,function(f){if(f.code){$("#usermsg-input").val("");f=f.data.sender;var g={text:d,datetime:"\u521a\u521a"};$("#contact-message-list").append(userMsg.gensSenderTemplate(f,g))}else $.message({title:"\u63d0\u793a",message:"\u9519\u8bef\uff1a"+f.msg,type:"error"})})}else $.message({title:"\u63d0\u793a",message:"\u83b7\u53d6\u8054\u7cfb\u4eba\u51fa\u9519",type:"error"})});
userMsg.eventInit()},userCenterInit:function(){userCenter.persenalInit()},pjax_complete:function(){this.init()}},archiveInit={init:function(){this.funcInit()},funcInit:function(){this.archiveEventInit();this.commentInit();this.fansFuncInit();this.circleFuncInit();this.repostFuncInit();this.archAuthorTabShowInit();this.archAuthorTabsClickInit();this.iasInit();this.lazyloadInit()},postRepostArticle:function(a,c,b,d,e,f){if(0>userId)return $.message({title:"\u63d0\u793a",message:"\u8bf7\u767b\u5f55\u540e\u64cd\u4f5c",
type:"error"}),!1;a={title:indexInput.loginUserName+"\u8f6c\u53d1\u4e86"+e.substring(0,20),text:'[repost href="'+a+'" bannerimg="'+b+'" repousername="'+d+'" repostext="'+e+"\" category='"+f+"']","fields[articleType]":"repost","fields[excerpt]":c,markdown:1,"category[]":1,visibility:"publish",allowComment:1,allowPing:1,allowFeed:1,do:"publish"};postArticle(a,!1)},repostFuncInit:function(){var a=$("#repostComment");$(".share-btn").unbind("click").bind("click",function(c){$("#repostModal").modal("show");
$("#repostModal").on("shown.bs.modal",function(){a.focus()})});$("#repostBtn").unbind("click").bind("click",function(c){c=a.val();var b=a.data("posthref"),d=/src=['"]?([^'"]*)['"]?/i,e=$(".article-content").html().match(/<img.*?(?:>|\/>)/i),f="";e&&0<e.length&&(e=e[0].match(d))&&0<e.length&&(f=e[1]);(d=f.match(d))&&0<d.length&&(f=d[1]);d=a.data("username");e=a.data("excerpt");var g=a.data("category");"undefine"===e&&(e="");archiveInit.postRepostArticle(b,c,f,d,e,g);$("#repostModal").modal("hide")});
$(".repost-row a").unbind("cilck").bind("click",function(c){var b=$(this).attr("href");$.pjax({url:b,container:"#pjax-container"});c.stopPropagation()})},postFansArticle:function(a,c,b,d){$.post(gconf.oneaction,{type:"getfocusmid"},function(e){e?(e=parseInt(e),postArticle({title:indexInput.loginUserName+"\u5173\u6ce8\u4e86\u5708\u53cb"+b,text:'[focususer href="'+a+'" avatar="'+c+'" username="'+b+'" sign="'+d+'" ]',"fields[articleType]":"focususer","fields[excerpt]":"\u5173\u6ce8\u4e86\u5708\u53cb"+
b,markdown:1,"category[]":e,visibility:"publish",allowComment:1,allowPing:1,allowFeed:1,do:"publish"},!1)):console.log(e)})},fansFuncInit:function(){var a=this;$(".fan-event").unbind("click").bind("click",function(c){if(0<userId){c=parseInt($(this).data("authorid"));var b="\u5173\u6ce8"===$.trim($(this).text())?"follow":"unfollow";if(parseInt(userId)===c)$.message({title:"\u63d0\u793a",message:"\u81ea\u5df1\u4e0d\u80fd\u5173\u6ce8\u81ea\u5df1\uff01",type:"warning"});else{$(this).attr("disabled",!0);
var d=this;$.post(gconf.index,{followuser:1,follow:b,uid:userId,fid:c},function(e){if(e)if("unfollow"===b)$(d).text("\u5173\u6ce8"),$(d).addClass("fans"),$(d).removeClass("fansed");else if($(d).text("\u5df2\u5173\u6ce8"),$(d).addClass("fansed"),$(d).removeClass("fans"),.3>=Math.random()){if($(d).attr("data-author_page")){e=$(d).parent().siblings().data("authorhref");var f=$(".author-avatar").attr("src");var g=$(".author_page-name").text();var h=$(".author-sign").text()}else h=$(d).parent().siblings(),
e=h.attr("href"),f=h.children("img").attr("src"),g=h.children("div").children(".oDrAC").text(),h=h.children("div").children(".ezzhLs").text();a.postFansArticle(e,f,g,h)}$(d).attr("disabled",!1)})}}else $.message({title:"\u63d0\u793a",message:"\u6ca1\u6709\u767b\u5f55\uff01",type:"warning"})})},circleFuncInit:function(){$(".circle-event").unbind("click").bind("click",function(a){if(0<userId){a=parseInt($(this).data("categoryid"));var c="\u52a0\u5165"===$.trim($(this).text())?"follow":"unfollow";$(this).attr("disabled",
!0);var b=this;$.post(gconf.index,{followcircle:1,follow:c,uid:userId,mid:a},function(d){d&&("unfollow"===c?($(b).text("\u52a0\u5165"),$(b).addClass("fans"),$(b).removeClass("fansed")):($(b).text("\u5df2\u52a0\u5165"),$(b).addClass("fansed"),$(b).removeClass("fans")));$(b).attr("disabled",!1)})}else $.message({title:"\u63d0\u793a",message:"\u6ca1\u6709\u767b\u5f55\uff01",type:"warning"})})},archAuthorTabShowInit:function(){var a=$(".react-tabs__tab-list"),c=a.find("li:first-child");0<a.length&&setTimeout(function(){var b=
a.first().offset().left;b=c.first().offset().left-b;var d=$(".line");d.css({transform:"translateX("+b+"px)"});d.show()},100)},archiveLoadRebindInit:function(){archiveInit.fansFuncInit();indexInput.articleClickInit();archiveInit.lazyloadInit()},archAuthorTabsClickInit:function(){var a=$(".react-tabs__tab-list");if(0<a.length){var c=a.first().offset().left,b=$(".line");a.children().each(function(d,e){$(e).click(function(f){var g=$(e).data("tabindex");$(this).addClass("react-tabs__tab--selected").siblings().removeClass("react-tabs__tab--selected");
b.width($(e).width());f=$(e).offset().left-c;b.css({transform:"translateX("+f+"px)"});$.ajax({url:"?tabindex="+g,method:"get",success:function(h){h=$.parseHTML(h);try{var k=$(".item-container",h);if(0>=k.length)return $.message({title:"\u901a\u77e5",message:"\u670d\u52a1\u5668\u8fd4\u56de\u9519\u8bef\uff0c\u8bf7\u91cd\u8bd5",type:"error"});var m=k.html();0>=$(".pagination",h).length&&(1===g||2===g)?$(".pagination").css("display","none"):0<$(".pagination",h).length&&(0===g||3===g)&&$(".pagination").css("display",
"flex");$(".item-container").html(m);var l=$(".archive-content");l.removeClass(function(n,p){return(p.match(/(^|\s)tabindex-\S+/g)||[]).join("")});l.addClass("tabindex-"+g);archiveInit.archiveLoadRebindInit()}catch(n){console.log(n)}}})})})}},archiveEventInit:function(){$("#agree-btn").on("click",function(){$(this).get(0).disabled=!0;$(this).children().css("fill","rgb(228, 88, 62)");$.ajax({url:gconf.index,type:"post",data:"agree="+$(this).attr("data-cid"),async:!0,timeout:3E4,cache:!1,success:function(a){/\d/.test(a)&&
$(".agree-num").html(a)},error:function(){$(this).get(0).disabled=!1}})})},commentInit:function(){function a(){$(".comment-reply a").click(function(){d=$(this).parent().parent().parent().attr("id")});$("#cancel-comment-reply-link").click(function(){d=""})}var c=$("html,body"),b="",d="";a();var e=$("#comment-form"),f=$(".submit.btn.comment-submit");f.unbind("click").bind("click",function(g){$(this).attr("disabled",!0);e.submit()});e.submit(function(){var g=$(this).serializeArray();g[0].value=safe.stripscript(g[0].value);
""===$.trim(g[0].value)?($.message({title:"\u63d0\u793a",message:"\u8bf7\u8f93\u5165\u5185\u5bb9",type:"error"}),f.attr("disabled",!1)):$.ajax({url:$(this).attr("action"),type:"post",data:g,error:function(){alert("\u63d0\u4ea4\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5\u7f51\u7edc\u5e76\u91cd\u8bd5\u6216\u8005\u8054\u7cfb\u7ba1\u7406\u5458\u3002");f.attr("disabled",!1);return!1},success:function(h){f.attr("disabled",!1);if($(".comment-list",h).length){b=$(".comment-list",h).html().match(/id="?comment-\d+/g).join().match(/\d+/g).sort(function(m,
l){return m-l}).pop();$(".page-navigator .prev").length&&""==d&&(b="");d?(h=$("#comment-"+b,h).hide(),0>=$("#"+d).find(".comment-children").length&&$("#"+d).append("<div class='comment-children'><ol class='comment-list'></ol></div>"),b&&$("#"+d+" .comment-children .comment-list").prepend(h),d=""):(h=$("#comment-"+b,h).hide(),$(".comment-list").length||$(".comment-detail").prepend("<h2 class='comment-num'>0 \u6761\u8bc4\u8bba</h2><ol class='comment-list'></ol>"),$(".comment-list").prepend(h));$("#comment-"+
b).fadeIn();var k;$(".comment-num").length?(k=parseInt($(".comment-num").text().match(/\d+/)),$(".comment-num").html($(".comment-num").html().replace(k,k+1))):0;TypechoComment.cancelReply();$("#textarea").val("");$(".comment-reply a, #cancel-comment-reply-link").unbind("click");a();b?c.animate({scrollTop:$("#comment-"+b).offset().top-50},300):c.animate({scrollTop:$("#comments").offset().top-50},300)}else return alert("\u60a8\u8f93\u5165\u7684\u5185\u5bb9\u4e0d\u7b26\u5408\u89c4\u5219\u6216\u8005\u56de\u590d\u592a\u9891\u7e41\uff0c\u8bf7\u4fee\u6539\u5185\u5bb9\u6216\u8005\u7a0d\u7b49\u7247\u523b\u3002"),
!1}});return!1})},lazyloadInit:function(){},iasInit:function(){var a=$(".a-pageLink .next");0<a.length||a.attr("style","display:none");a.unbind("click").bind("click",function(){var b=$(this).attr("href"),d=$(".a-pageLink .donut");void 0!==b&&$.ajax({url:b,type:"get",beforeSend:function(){a.hide();d.fadeIn()},error:function(e){},success:function(e){var f=$(e).find(".post-article");d.hide();$(".list").append(f).fadeIn();e=$(e).find(".a-pageLink .next").attr("href");void 0!==e?(a.attr("href",e),a.fadeIn()):
(a.attr("style","display:none"),$(".a-pageLink").append('<a href="javascript:;" rel="nofollow">\u52a0\u8f7d\u5b8c\u6bd5</a>'));archiveInit.archiveLoadRebindInit()}});return!1});var c=$(".a-pageLink .comments-next");0<c.length||c.attr("style","display:none");c.unbind("click").bind("click",function(){var b=$(this).attr("href"),d=$(".a-pageLink .donut");void 0!==b&&$.ajax({url:b,type:"get",beforeSend:function(){c.hide();d.fadeIn()},error:function(e){},success:function(e){var f=$(e).find(".comment-detail>.comment-list>.comment-list-item");
d.hide();$(".comment-detail>.comment-list").append(f).fadeIn();e=$(e).find(".a-pageLink .comments-next").attr("href");void 0!==e?(c.attr("href",e),c.fadeIn()):(c.attr("style","display:none"),$(".a-pageLink").append('<a href="javascript:;" rel="nofollow">\u52a0\u8f7d\u5b8c\u6bd5</a>'))}});return!1})},pjax_complete:function(){this.archiveEventInit();this.commentInit();this.repostFuncInit();this.archAuthorTabShowInit();this.iasInit();this.lazyloadInit()}},recommendInit={init:function(){this.autoDirayWith()},
autoDirayWith:function(){for(var a=document.getElementsByClassName("diary-item"),c=0;c<a.length;c++)a[c].style.height=a[c].offsetWidth+"px"},pjax_complete:function(){this.autoDirayWith()}},tagsManageInit={init:function(){this.circleEditBtn()},circleEditBtn:function(){var a=$(".circle-item .edit-btn button"),c=$("#circle-edit-save"),b=-1;a.unbind("click").bind("click",function(d){b=parseInt($(this).data("categoryid"));d=$(this).data("name");$("#selectCircle").val(d);$("#changeCatagModal").modal("show")});
c.unbind("click").bind("click",function(d){0< !b||(d=$("#changeCircle").val(),$.ajax({data:{url:gconf.index,changeCircleCat:1,mid:b,changetomid:d},method:"POST",success:function(e){"success"===e&&$.message({title:"\u901a\u77e5",message:"\u66f4\u6539\u6210\u529f\uff0c\u5237\u65b0\u540e\u53ef\u89c1",type:"info"});$("#changeCatagModal").modal("hide")},error:function(e){console.log(e);$("#changeCatagModal").modal("hide")}}))})},pjax_complete:function(){this.circleEditBtn()}},oneMap={AMapUrl:"https://webapi.amap.com/loader.js",
init:function(a){if(!a)return!1;this.AMap=a;this.autoCompleteInit(a);this.geolocationInit(a);this.mapContainerInit(a,this.geolocation)},pjax_complete:function(){oneMap.AMap?(oneMap.autoCompleteInit(oneMap.AMap),oneMap.mapContainerInit(oneMap.AMap,oneMap.geolocation)):$.getScript(oneMap.AMapUrl,function(){oneMap.amapLoadInit()});this.restoreFromLocal()},amapLoadInit:function(){if(!(0>userId)){var a=new XMLHttpRequest;a.open("POST",gconf.oneaction,!0);a.setRequestHeader("Content-type","application/x-www-form-urlencoded");
a.send("type=amapKey");a.onreadystatechange=function(){if(4===a.readyState&&200===a.status){var c=a.responseText;c=JSON.parse(c);c.status&&c.data.jskey&&(localStorage.setItem("amapkey",c.data),AMapLoader.load({key:c.data.jskey,version:"1.4.15",plugins:["AMap.Autocomplete","AMap.Geolocation","AMap.Geocoder","AMap.Marker"]}).then(function(b){oneMap.init(b)}).catch(function(b){console.error(b)}))}}}},restoreFromLocal:function(){var a=localStorage.getItem("address");if(a){a=JSON.parse(a);var c=document.getElementById("ad-address");
if(c){var b=document.getElementById("address-input");b.value=a.name;b.style.width="fit-content";document.getElementById("ad-name").value=a.name;document.getElementById("ad-district").value=a.district;c.value=a.address}}},save2local:function(a,c,b){a=JSON.stringify({name:a,district:c,address:b});localStorage.setItem("address",a)},geolocationInit:function(a){var c=new a.Geolocation({enableHighAccuracy:!0,position:"RB",buttonOffset:new a.Pixel(10,20),zoomToAccuracy:!0,getCityWhenFail:!0,needAddress:!0});
this.geolocation=c;c.getCurrentPosition(function(b,d){if("complete"===b){if(d.status){var e=document.getElementById("address-input");e&&(new a.Autocomplete).search(d.formattedAddress,function(f,g){0<g.count&&(e.value=g.tips[0].name,e.style.width="fit-content",document.getElementById("ad-name").value=g.tips[0].name,document.getElementById("ad-district").value=g.tips[0].district,document.getElementById("ad-address").value=g.tips[0].address,oneMap.save2local(g.tips[0].name,g.tips[0].district,g.tips[0].address))})}}else $.message({title:"\u5b9a\u4f4d\u5931\u8d25",
message:"\u5931\u8d25\u539f\u56e0\u6392\u67e5\u4fe1\u606f:"+d.message,type:"error"})})},autoCompleteInit:function(a){var c=document.getElementById("ad-name");c&&(this.autoComplete=new a.Autocomplete({city:"\u5168\u56fd",input:"address-input"}),this.autoComplete.on("select",function(b){c.value=b.poi.name;document.getElementById("ad-district").value=b.poi.district;document.getElementById("ad-address").value=b.poi.address;oneMap.save2local(b.poi.name,b.poi.district,b.poi.address)}))},mapContainerInit:function(a,
c){this.geocoder&&this.marker||(this.geocoder=new a.Geocoder({}),this.marker=new a.Marker);if(document.getElementById("amap-container")){var b=new a.Map("amap-container",{resizeEnable:!0,zoom:15,mapStyle:"amap://styles/fresh"});if(a=utils.getQueryString("name")){var d=this.marker;this.geocoder.getLocation(district+a,function(e,f){"complete"===e&&f.geocodes.length?(d.setPosition(f.geocodes[0].location),b.add(d),b.setFitView(d)):console.error("\u6839\u636e\u5730\u5740\u67e5\u8be2\u4f4d\u7f6e\u5931\u8d25")})}else b.addControl(c)}}},
userMsg={eventInit:function(){function a(){var f=!0,g=function(){f?(f=!1,b.html("\u3010\u65b0\u6d88\u606f\u3011"+d),e.hide()):(f=!0,b.html("\u3010\u3000\u3000\u3000\u3011"+d),e.show());window._titleMsgTime=setTimeout(function(){g()},600)};g()}function c(){b&&(b.html(d),window.clearTimeout(window._titleMsgTime))}var b=$("title"),d=b.html(),e=$("#msg-tip");this.getUnread(function(f){f.code?0<f.data.num?a():c():c()});$("#chat-tab").unbind("shown.bs.tab").bind("shown.bs.tab",function(f){userMsg.scrollToBottom()})},
getUnread:function(a){""!==userId&&void 0!==userId&&$.post(gconf.index,{handleMsg:1,type:"getUnRead"},function(c){c=JSON.parse(c);if(c.code&&0<c.data.num){var b=$("#my-message");b.html(b.html()+(" ("+c.data.num+")"))}a(c)})},getMsg:function(a,c){$.post(gconf.index,{handleMsg:1,type:"getUserMsg",fid:a},function(b){b=JSON.parse(b);c(b);userMsg.scrollToBottom()})},sendMsg:function(a,c,b){$.post(gconf.index,{handleMsg:1,type:"sendMsg",to:a,text:c},function(d){d=JSON.parse(d);b(d);userMsg.scrollToBottom()})},
gensSenderTemplate:function(a,c){return'<div class="media sender"><div class="media-content"><div class="media-left"><figure class="image is-circle is-32"><img src="'+a.avatar+'" title="gogobody"></figure></div>\n                                            <div class="media-body"><div class="contact-message-item">'+c.text+'</div></div></div>\n                                            <div class="media-right text-xs text-muted">'+c.datetime+"</div></div>"},gensReceiverTemplate:function(a,c){return'<div class="media receiver"><div class="media-content"><div class="media-left"><figure class="image is-circle is-32"><img src="'+
a.avatar+'" title="gogobody"></figure></div>\n                                            <div class="media-body"><div class="contact-message-item">'+c.text+'</div></div></div>\n                                            <div class="media-right text-xs text-muted">'+c.datetime+"</div></div>"},buildChatBox:function(a){userMsg.getMsg(a,function(c){if(c.code){var b=c.data.receiver,d=c.data.sender,e=$("#chat-tab"),f=$("#contact-message-list");if(b.uid){e.children("a").text(b.name);e.children("a").data("uid",
b.uid);var g="";c.data.message.forEach(function(h){g="sender"===h.from?g+userMsg.gensSenderTemplate(d,h):g+userMsg.gensReceiverTemplate(b,h)});f.html(g);e.show();(c=document.querySelector("#chat-tab a"))&&(new bootstrap.Tab(c)).show()}}userMsg.scrollToBottom()})},scrollToBottom:function(){var a=$("#contact-messages");a.scrollTop(a[0].scrollHeight)},pjax_complete:function(){}},userCenter={persenalInit:function(){var a=$("#OneCircle"),c=$("#OneCircle button[type='submit']");c.unbind("click").bind("click",
function(b){$(this).attr("disabled",!0);a.submit()});a.submit(function(){var b=$(this).serializeArray();$.ajax({url:$(this).attr("action"),type:"post",data:b,error:function(){alert("\u63d0\u4ea4\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5\u7f51\u7edc\u5e76\u91cd\u8bd5\u6216\u8005\u8054\u7cfb\u7ba1\u7406\u5458\u3002");c.attr("disabled",!1);return!1},success:function(d){c.attr("disabled",!1);window.location.reload()}});return!1});$("#avatar-uploader").show()}},safe={stripscript:function(a){return a.replace(/<script.*?>.*?<\/script>/ig,
"")}},floatEle={init:function(){this.fabtns=$("#float_action_buttons");this.backToTopBtn=$("#fabtn_back_to_top");this.toggleSidesBtn=$("#fabtn_toggle_sides");this.readingProgressBar=$("#fabtn_reading_progress_bar");this.readingProgressDetails=$("#fabtn_reading_progress_details");this.goToComment=$("#fabtn_go_to_comment");this.isScrolling=!1;this.eventInit();this.changefabtnDisplayStatus()},eventInit:function(){var a=this;this.backToTopBtn.on("click",function(){floatEle.isScrolling||(floatEle.isScrolling=
!0,setTimeout(function(){floatEle.isScrolling=!1},600),$("body,html").animate({scrollTop:0},600))});0<$("#comment").length?$("#fabtn_go_to_comment").removeClass("d-none"):$("#fabtn_go_to_comment").addClass("d-none");this.goToComment.on("click",function(){gotoHash("#comment",600);$("#post_comment_content").focus()});"left"===localStorage.Argon_fabs_Floating_Status&&this.fabtns.addClass("fabtns-float-left");this.toggleSidesBtn.on("click",function(){a.fabtns.addClass("fabtns-unloaded");setTimeout(function(){a.fabtns.toggleClass("fabtns-float-left");
a.fabtns.hasClass("fabtns-float-left")?localStorage.Argon_fabs_Floating_Status="left":localStorage.Argon_fabs_Floating_Status="right";a.fabtns.removeClass("fabtns-unloaded");a.hideAlltoolTip()},300)});this.fabtns.removeClass("fabtns-unloaded")},changefabtnDisplayStatus:function(){var a=$(window).scrollTop()/Math.max($(document).height()-$(window).height(),.01);this.readingProgressDetails.html((100*a).toFixed(0)+"%");this.readingProgressBar.css("width",(100*a).toFixed(0)+"%");400<=$(window).scrollTop()||
.5<=a?this.backToTopBtn.removeClass("fabtn-hidden"):this.backToTopBtn.addClass("fabtn-hidden")},hideAlltoolTip:function(){$("#float_action_buttons button").tooltip("hide")}},blog={init:function(){this.init_load_more()},pjax_complete:function(){this.init_load_more()},eventInit:function(){},init_load_more:function(){var a=$(".j-loadmore a");a.attr("data-href",a.attr("href"));a.removeAttr("href");a.on("click",function(){if(!$(this).attr("disabled")){$(this).html("loading...");$(this).attr("disabled",
!0);var c=$(this).attr("data-href"),b=this;c&&$.ajax({url:c,type:"get",success:function(d){$(b).removeAttr("disabled");$(b).html("\u67e5\u770b\u66f4\u591a");var e=$(d).find(".article-list:not(.sticky)");$(".j-index-article.article").append(e);(d=$(d).find(".j-loadmore a").attr("href"))?$(b).attr("data-href",d):$(".j-loadmore").remove()}})}})}},utils={getQueryString:function(a){a=a.replace(/[]/,"[").replace(/[]/,"[").replace(/[]/,"\\]");a=(new RegExp("[\\?&]"+a+"=([^&#]*)")).exec(window.parent.location.href);
return null==a?"":decodeURI(a[1])},debounce:function(a,c,b){function d(){var l=Date.now()-h;l<c&&0<=l?e=setTimeout(d,c-l):(e=null,b||(k=a.apply(g,f),g=f=null))}var e,f,g,h,k;null==c&&(c=100);var m=function(){g=this;f=arguments;h=Date.now();var l=b&&!e;e||(e=setTimeout(d,c));l&&(k=a.apply(g,f),g=f=null);return k};m.clear=function(){e&&(clearTimeout(e),e=null)};m.flush=function(){e&&(k=a.apply(g,f),g=f=null,clearTimeout(e),e=null)};return m}};
$(function(){$(window).unbind("scroll").bind("scroll",function(){floatEle.changefabtnDisplayStatus()});window.onscroll=utils.debounce(function(){floatEle.hideAlltoolTip()},300);indexInput.init();tagsManageInit.init();recommendInit.init();archiveInit.init();floatEle.init();blog.init()});
var pjaxInit=function(){$('[data-toggle="tooltip"]').tooltip();indexInput.pjax_complete();archiveInit.init();recommendInit.pjax_complete();owoInit();tagsManageInit.pjax_complete();oneMap.pjax_complete();blog.pjax_complete();$("article.post")&&Prism.highlightAll();userMsg.pjax_complete()};
function postArticle(a,c){$.post(gconf.oneaction,{type:"getsecuritytoken"},function(b){b.code?$.ajax({url:gconf.index+"/action/contents-post-edit?do=publish&_="+b.data,type:"post",data:a,success:function(d){c&&setTimeout(function(){$.pjax.reload("#pjax-container",{container:"#pjax-container",fragment:"#pjax-container",timeout:8E3});$.message({title:"\u63d0\u793a",message:"\u53d1\u5e03\u6210\u529f\uff0c\u6ca1\u51fa\u6765\u7684\u8bdd\u5c31\u5237\u65b0\u4e00\u4e0b\u5427",type:"success"})},800)},error:function(d){return $.message({title:"\u63d0\u793a",
message:"code:"+d.status+"err:"+d.responseText+d,type:"error"})}}):$.message({title:"\u63d0\u793a",message:"\u8bf7\u68c0\u67e5\u63d2\u4ef6\u662f\u5426\u6b63\u786e\u5b89\u88c5\uff01",type:"error"});return!1})}
function delComments(a,c){confirm("\u60a8\u771f\u7684\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f")&&$.post(gconf.oneaction,{type:"getsecuritytoken"},function(b){b.code&&$.ajax({url:gconf.index+a+"&_="+b.data,type:"post",success:function(d){c&&setTimeout(function(){$.pjax.reload("#pjax-container",{container:"#pjax-container",fragment:"#pjax-container",timeout:8E3});$.message({title:"\u63d0\u793a",message:"\u5220\u9664\u6210\u529f",type:"success"})},800);d.success&&$.message({title:"\u63d0\u793a",message:"\u5220\u9664\u6210\u529f",
type:"success"});return!1},error:function(d){$.message({title:"\u63d0\u793a",message:"code:"+d.status+"err:"+d.responseText+d,type:"error"});return!1}});return!1});return!1}
function submitForm(a){a=$(a);a.val("\u53d1\u9001\u4e2d...");var c=$("#post-title"),b=$("#text").val(),d=new Date,e=d.getFullYear(),f=d.getMonth()+1;d=d.getDate();e=e+"/"+f+"/"+d;0<b.length&&""!==b&&c.val(b.substring(0,25));if("default"===indexInput.nowtype)0!==b.length&&""!==b||c.val("\u56fe\u6587\u5c0f\u8bb0\u4e8b~"+e),1===indexInput.additionArray.length?(b+="\n\n",indexInput.additionArray.forEach(function(k){b=b+"![]("+k+")"}),b+="\n\n"):1<indexInput.additionArray.length&&(b+="\n[gallery]",indexInput.additionArray.forEach(function(k){b=
b+"![]("+k+")"}),b+="[endgallery]\n");else if("link"===indexInput.nowtype)if(0<indexInput.additionArray.length)0<indexInput.additionArray[1].length&&""!==indexInput.additionArray[1]?c.val(indexInput.additionArray[1].substring(0,15)):c.val("\u5206\u4eab\u4e00\u4e2a\u94fe\u63a5~"+e),b=b?'[pureLink comment="'+b+'..." text="'+indexInput.additionArray[1]+'" link="'+indexInput.additionArray[0]+'"]':'[pureLink comment="'+indexInput.additionArray[1].substring(0,60)+'..." text="'+indexInput.additionArray[1]+
'" link="'+indexInput.additionArray[0]+'"]';else return $.message({title:"\u63d0\u793a",message:"\u8bf7\u8f93\u5165\u6b63\u786e\u94fe\u63a5",type:"warning"}),a.val("\u53d1\u9001"),!1;else if("video"===indexInput.nowtype)if(0<indexInput.additionArray.length)0!==b.length&&""!==b||c.val("\u5206\u4eab\u89c6\u9891~"+e),indexInput.additionArray.forEach(function(k){b=b+'\n[video src="'+k+'"]\n'});else return $.message({title:"\u63d0\u793a",message:"\u8bf7\u8f93\u5165\u6b63\u786e\u94fe\u63a5",type:"warning"}),
a.val("\u53d1\u9001"),!1;else if("bilibili"===indexInput.nowtype)if(0<indexInput.additionArray.length)0!==b.length&&""!==b||c.val("\u5206\u4eabbilibili\u89c6\u9891~"+e),indexInput.additionArray.forEach(function(k){b=b+'\n[bilibili bv="'+k+'" p="1"]\n'});else return $.message({title:"\u63d0\u793a",message:"\u8bf7\u8f93\u5165\u6b63\u786e\u94fe\u63a5",type:"warning"}),a.val("\u53d1\u9001"),!1;if(0===b.length||""===b)return $.message({title:"\u63d0\u793a",message:"\u8981\u4e0d\u8f93\u5165\u70b9\u4e1c\u897f\u5427~",
type:"warning"}),a.val("\u53d1\u9001"),!1;var g=!1,h=$("#category").val();if("undefined"!==typeof allCategories)allCategories.forEach(function(k){k[1]===h&&(g=!0)}),!1===g&&(h=allCategories[0][1]);else return $.message({title:"\u63d0\u793a",message:"\u8fd8\u6ca1\u6709\u521b\u5efa\u5708\u5b50",type:"error"}),!1;a={title:c.val(),text:b,"fields[articleType]":indexInput.nowtype,markdown:1,"category[]":h,name:$("#ad-name").val(),district:$("#ad-district").val(),address:$("#ad-address").val(),visibility:"publish",
allowComment:1,allowPing:1,allowFeed:1,do:"publish"};postArticle(a,!0);return!1}function del_article(a,c){a=$(a).attr("href");!0===confirm("\u60a8\u771f\u7684\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f")&&$.ajax({url:a,method:"post",success:function(b){$.message({title:"\u63d0\u793a",message:"\u5220\u9664\u6210\u529f\uff01",type:"success"})},error:function(b){$.message({title:"\u63d0\u793a",message:"\u5220\u9664\u6210\u529f\uff01",type:"success"})}});return!1}
function videoToggle(a,c,b){$(c).hasClass("video-slim")?($(c).children().children("span:first-child").html('<svg class="bi bi-arrows-angle-contract" width=".7em" height=".7em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M9.5 2.036a.5.5 0 0 1 .5.5v3.5h3.5a.5.5 0 0 1 0 1h-4a.5.5 0 0 1-.5-.5v-4a.5.5 0 0 1 .5-.5z"/>\n  <path fill-rule="evenodd" d="M14.354 1.646a.5.5 0 0 1 0 .708l-4.5 4.5a.5.5 0 1 1-.708-.708l4.5-4.5a.5.5 0 0 1 .708 0zm-7.5 7.5a.5.5 0 0 1 0 .708l-4.5 4.5a.5.5 0 0 1-.708-.708l4.5-4.5a.5.5 0 0 1 .708 0z"/>\n  <path fill-rule="evenodd" d="M2.036 9.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-1 0V10h-3.5a.5.5 0 0 1-.5-.5z"/>\n</svg>'),
$(c).children().children("span:last-child").text("\u6536\u7f29"),$(c).removeClass("video-slim")):($(c).children().children("span:first-child").html('<svg width=".7em" height=".7em" viewBox="0 0 16 16" class="bi bi-arrows-angle-expand" fill="currentColor" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" d="M5.828 10.172a.5.5 0 0 0-.707 0l-4.096 4.096V11.5a.5.5 0 0 0-1 0v3.975a.5.5 0 0 0 .5.5H4.5a.5.5 0 0 0 0-1H1.732l4.096-4.096a.5.5 0 0 0 0-.707zm4.344-4.344a.5.5 0 0 0 .707 0l4.096-4.096V4.5a.5.5 0 1 0 1 0V.525a.5.5 0 0 0-.5-.5H11.5a.5.5 0 0 0 0 1h2.768l-4.096 4.096a.5.5 0 0 0 0 .707z"/>\n</svg>'),
$(c).children().children("span:last-child").text("\u5c55\u5f00"),$(c).addClass("video-slim"));$(a).collapse("toggle");b.stopPropagation();return!1}function checkURL(a){return!0===(new RegExp(/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[\-;:&=\+\$,\w]+@)?[A-Za-z0-9\.\-]+|(?:www\.|[\-;:&=\+\$,\w]+@)[A-Za-z0-9\.\-]+)((?:\/[\+~%\/\.\w\-_]*)?\??(?:[\-\+=&;%@\.\w_]*)#?(?:[\.!\/\\\w]*))?)/)).test(a)}
function gotoHash(a,c){0!==a.length&&0!==$(a).length&&(null==c&&(c=200),$("body,html").animate({scrollTop:$(a).offset().top-80},c))};
