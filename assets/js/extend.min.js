console.log(" %c Theme onecircle %c https://github.com/gogobody/onecircle","color:#444;background:#eee;padding:5px 0","color:#eee;background:#444;padding:5px");var stripscript=function(t){for(var e=new RegExp("[`^()|{}'\\[\\].<>/?~！……*——|{}‘”“↵\r\n]"),i="",n=0;n<t.length;n++)i+=t.substr(n,1).replace(e,"");return i};$(function(){$('[data-toggle="tooltip"]').tooltip(),$.extend({message:function(t){var e={title:"",message:" 操作成功",time:"3000",type:"success",showClose:!0,autoClose:!0,onClose:function(){}};"string"==typeof t&&(e.message=t),"object"==typeof t&&(e=$.extend({},e,t));var i,n=e.showClose?'<div class="c-message--close">×</div>':"",t=""!==e.title?'<h2 class="c-message__title">'+e.title+"</h2>":"",t='<div class="c-message animated animate__slideInRight"><i class=" c-message--icon c-message--'+e.type+'"></i><div class="el-notification__group">'+t+'<div class="el-notification__content">'+e.message+"</div>"+n+"</div></div>",n=$("body"),a=$(t),s=function(){a.addClass("animate__slideOutRight"),a.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){o()})},o=function(){a.remove(),e.onClose(e),clearTimeout(i)};$(".c-message").remove(),n.append(a),a.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){a.removeClass("messageFadeInDown")}),n.on("click",".c-message--close",function(t){s()}),e.autoClose&&(i=setTimeout(function(){s()},e.time))},showloading:function(t){var e=$.extend({},{selector:"header",choice:"append"},t),i='<div class="loading-container"><svg width="120" height="12px" viewBox="0 0 120 30" xmlns="http://www.w3.org/2000/svg" fill="#03A9F5" class="loading-svg"><circle cx="15" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="60" cy="15" r="9" fill-opacity="0.3"><animate attributeName="r" from="9" to="9" begin="0s" dur="0.8s" values="9;15;9" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from="0.5" to="0.5" begin="0s" dur="0.8s" values=".5;1;.5" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="105" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite"></animate></circle></svg></div>';"string"==typeof e.selector&&(t=$(e.selector),"append"===e.choice?t.append(i):"prepend"===e.choice?t.prepend(i):"after"===e.choice?t.after(i):"before"===e.choice&&t.before(i))},rmloading:function(){$(".loading-container").remove()}})});var indexInput={init:function(){this.loginUserName="",this.addArea=$(".add-area"),this.addAreaBtn=$(".add-area button"),this.addPicBtn=$("#addpic"),this.addLinkBtn=$("#addlink"),this.addVideoBtn=$("#addvideo"),this.addBilibiliBtn=$("#addbilibili"),this.uploadPic=$(".upload-pic"),this.showPanel=$(".show-panel.fbjukw"),this.additionArray=[],this.nowtype="default",this.articleType=$("#articleType"),this.funcInit()},funcInit:function(){this.indexEventInit(),this.login_ajax(),this.searchEventInit(),this.articleClickInit()},resetInputStatus:function(){this.additionArray=[]},changeType:function(t){this.nowtype!==t&&(this.nowtype=t,this.articleType.val(t),this.resetInputStatus(),$(".add-area input").val(""))},doParseDefaultFunc:function(t,e){$(t).html("解析中");var i,n=$(".add-area input"),a=n.val();checkURL(a)?(i='<div class="sc-AxjAm sc-AxirZ ciIrlj">\n<div class="eHTuZC" style="background-image: url('+a+');">\n<div class="cPHQWG">\n<svg viewBox="0 0 17 17" fill="currentColor">\n<path d="M9.565 8.595l5.829 5.829a.686.686 0 01-.97.97l-5.83-5.83-5.828 5.83a.686.686 0 01-.97-.97l5.829-5.83-5.83-5.828a.686.686 0 11.97-.97l5.83 5.829 5.829-5.83a.686.686 0 01.97.97l-5.83 5.83z"></path>\n</svg>\n</div>\n</div>\n</div>',e.showPanel.append(i),e.additionArray.push(a),e.addPicBtn.siblings().addClass("btn-disable"),n.val(""),$(".cPHQWG").unbind("click").bind("click",function(){var t=$(this).parent().css("backgroundImage").replace("url(","").replace(")","");e.additionArray.splice($.inArray(t,e.additionArray),1),$(this).parent().parent().remove(),0===e.additionArray.length&&e.addPicBtn.siblings().removeClass("btn-disable")})):$.message({title:"提示",message:"请输入正确的图片地址",type:"error"}),$(t).html("添加")},doParseLinkFunc:function(i,n){$(i).text("解析中");var a=$(".add-area input").val();checkURL(a)?$.post(gconf.oneaction,{type:"parsemeta",url:a},function(t){var e;t.code?((e=$(".sc-AxjAm.kgcKxQ")).css("display","block"),e.attr("href",a),$(".sc-AxjAm.kgcKxQ .hHnMup").html(t.data),n.additionArray=[],n.additionArray.push(a),n.additionArray.push(stripscript(t.data)),$(i).text("添加"),n.addLinkBtn.siblings().addClass("btn-disable"),$(".sc-AxjAm.sc-AxirZ.ezTcmd").unbind("click").bind("click",function(t){return $(".kgcKxQ").css("display","none"),t.stopPropagation(),n.addLinkBtn.siblings().removeClass("btn-disable"),!1})):($.message({title:"提示",message:"解析失败",type:"error"}),console.log(t)),$(i).text("添加")}):($.message({title:"提示",message:"请输入正确的地址",type:"error"}),$(i).text("添加"))},doParseVideoFunc:function(t,e){var i=$(".add-area input"),n=i.val();checkURL(n)?(e.additionArray.push(n),n='<div class="show-panel-inner"><div class="jLaetV"><div class="hHnMup">'+n+'</div></div>\n<div class="ezTcmd show-close">\n<div class="hyliOy">\n<svg viewBox="0 0 17 17" fill="#ccc">\n<path d="M9.565 8.595l5.829 5.829a.686.686 0 01-.97.97l-5.83-5.83-5.828 5.83a.686.686 0 01-.97-.97l5.829-5.83-5.83-5.828a.686.686 0 11.97-.97l5.83 5.829 5.829-5.83a.686.686 0 01.97.97l-5.83 5.83z"></path>\n</svg>\n</div>\n</div></div>',e.showPanel.append(n),e.addVideoBtn.siblings().addClass("btn-disable"),i.val(""),$(".show-close").unbind("click").bind("click",function(){var t=$(this).siblings().text();e.additionArray.splice($.inArray(t,e.additionArray),1),$(this).parent().remove(),0===e.additionArray.length&&e.addVideoBtn.siblings().removeClass("btn-disable")})):$.message({title:"提示",message:"请输入正确的视频地址",type:"error"})},doParseBilibiliFunc:function(t,e){var i=$(".add-area input"),n=i.val();e.additionArray.push(n);n='<div class="show-panel-inner"><div class="jLaetV"><div class="hHnMup">'+n+'</div></div>\n<div class="ezTcmd show-close">\n<div class="hyliOy">\n<svg viewBox="0 0 17 17" fill="#ccc">\n<path d="M9.565 8.595l5.829 5.829a.686.686 0 01-.97.97l-5.83-5.83-5.828 5.83a.686.686 0 01-.97-.97l5.829-5.83-5.83-5.828a.686.686 0 11.97-.97l5.83 5.829 5.829-5.83a.686.686 0 01.97.97l-5.83 5.83z"></path>\n</svg>\n</div>\n</div></div>';e.showPanel.append(n),e.addBilibiliBtn.siblings().addClass("btn-disable"),i.val(""),$(".show-close").unbind("click").bind("click",function(){var t=$(this).siblings().text();e.additionArray.splice($.inArray(t,e.additionArray),1),$(this).parent().remove(),0===e.additionArray.length&&e.addBilibiliBtn.siblings().removeClass("btn-disable")})},indexEventInit:function(){var e=this;$("#addpic").unbind("click").bind("click",function(){$(".add-area input").attr("placeholder","请输入图片链接"),"default"!==e.nowtype?(e.addArea.show(),e.uploadPic.show()):(e.addArea.toggle(),e.uploadPic.toggle()),e.changeType("default")}),$("#addlink,#addvideo,#addbilibili").unbind("click").bind("click",function(){e.uploadPic.hide();var t=$(this).data("type");"link"===t?$(".add-area input").attr("placeholder","请输入链接"):"video"===t?$(".add-area input").attr("placeholder","请输入视频链接"):"bilibili"===t&&$(".add-area input").attr("placeholder","请输入bv号"),e.nowtype!==t?e.addArea.show():e.addArea.toggle(),e.changeType(t)}),this.addAreaBtn.unbind("click").bind("click",function(){"default"===e.nowtype?e.doParseDefaultFunc(this,e):"link"===e.nowtype?e.doParseLinkFunc(this,e):"video"===e.nowtype?e.doParseVideoFunc(this,e):"bilibili"===e.nowtype&&e.doParseBilibiliFunc(this,e)}),$("#text").bind("input propertychange",function(){var t=$(".pub.eynkqj");$(this).val()?t.removeAttr("disabled"):(t.attr("disabled",!0),t.css("background-color","rgb(255, 241, 147)"))}),$(".sc-AxjAm.bwpEWU.gsmhQy").bind("input propertychange",function(){var t=$(".sc-AxjAm.eVNRGW");$(this).val()?t.removeAttr("disabled"):t.attr("disabled",!0)});var s=$("#topic-search-downshift-input");s.autoComplete({minChars:0,source:function(t,e){t=t.toLowerCase();for(var i=allCategories,n=[],a=0;a<i.length;a++)~i[a][0].toLowerCase().indexOf(t)&&n.push(i[a]);0===n.length&&n.push(["未搜索到结果",-1,"",""]),e(n)},renderItem:function(t,e){var i=new Array;return i[0]=t[0],i[1]=t[1],-1===t[1]?'<div class="autocomplete-suggestion" data-val="'+JSON.stringify(i).replace(/"/g,"'")+'" disabled><div class="sc-AxjAm oDrAC" disabled>'+t[0]+"</div></div>":'<div class="autocomplete-suggestion" data-val="'+JSON.stringify(i).replace(/"/g,"'")+'"><img src="'+t[2]+'" class="sc-AxjAm gLHjJQ"><div class="sc-AxjAm oDrAC">'+t[0]+"</div></div>"},onSelect:function(t,e,i){e=e.replace(/'/g,'"');var n=JSON.parse(e),a=n[1],e=$("#category");if(-1===a)return $("#topic-search-downshift-input").val(""),void e.val(1);s.val(n[0]),e.val(a)}}),$(".post-content-inner-link a").click(function(t){t.stopPropagation()})},searchEventInit:function(){var t=$(".search-block-icon"),e=$("#search-block");t.unbind("click").bind("click",function(){"none"===e.css("display")?e.slideDown():$(".search-block").slideUp()}),$(".close").unbind("click").bind("click",function(){$(".search-block").slideUp()})},login_ajax:function(){var n=this,a=$("#login-submit"),s=$("#navbar-login-user"),o=$("#navbar-login-password");function r(){a.attr("disabled",!0).fadeTo("",1)}function l(){a.attr("disabled",!1).fadeTo("",1)}this.canLogin=!0,$("#Login_form").submit(function(){if(n.canLogin){n.canLogin=!1;var e=this;if($(this).hasClass("banLogin"))return location.reload(),!1;a.attr("disabled",!0).fadeTo("slow",.5);var i=s.val(),t=o.val();return""===i?(n.canLogin=!0,$.message({title:"登录通知",message:"必须填写用户名",type:"warning"}),s.focus(),r()):""===t?(n.canLogin=!0,$.message({title:"登录通知",message:"请填写密码",type:"warning"}),o.focus(),r()):(a.addClass("active"),$("#spin-login").addClass("show inline"),$.post(gconf.oneaction,{type:"getsecurl",url:window.location.href},function(t){return t.code?($("#Login_form").attr("action",t.data),void $.ajax({url:t.data,type:$(e).attr("method"),data:$(e).serializeArray(),error:function(){return n.canLogin=!0,$.message({title:"登录通知",message:"提交出错",type:"error"}),l()},success:function(t){t=$.parseHTML(t),a.removeClass("active"),$("#spin-login").removeClass("show inline");try{if($("#Logged-in",t).length<=0)return n.canLogin=!0,l(),$.message({title:"登录通知",message:"用户名或者密码错误，请重试",type:"error"});r(),t=$("#easyLogin",t).html(),$("#easyLogin").html(t),$.message({title:"登录通知",message:'登录成功:&nbsp;<a onclick="location.reload();">点击这里刷新页面，或等待自动刷新</a>',type:"success"}),n.canLogin=!0,n.loginUserName=i,setTimeout(function(){location.reload()},500)}catch(t){alert("按下F12，查看输出错误信息"),n.canLogin=!0}}})):$.message({title:"提示",message:"获取securl失败",type:"error"})})),!1}})},loginBan:function(){var t=$("#Login_form");t.hasClass("banLogin")||(t.addClass("banLogin"),$("#navbar-login-user").attr("disabled","disabled"),$("#navbar-login-password").attr("disabled","disabled"))},resetLoginAction:function(e){0<userId||$.post(gconf.oneaction,{type:"getsecurl",url:window.location.href},function(t){return t.code?($("#Login_form").attr("action",t.data),void e()):$.message({title:"提示",message:"获取securl失败",type:"error"})})},articleClickInit:function(){$.support.pjax&&$("article[do-pjax]").unbind().bind("click",function(t){var e=$(this).data("url");"IMG"===t.target.tagName||$.pjax({url:e,container:"#pjax-container"})}),$(".content-action").each(function(e,t){$(t).find(".btn-like").on("click",function(t){return $(this).get(0).disabled=!0,$.ajax({url:$(this).data("link"),type:"post",data:"agree="+$(this).attr("data-cid"),async:!0,timeout:3e4,cache:!1,success:function(t){/\d/.test(t)&&$($(".btn-like").find("span.agree-num")[e]).html(t)},error:function(){$(this).get(0).disabled=!1}}),t.stopPropagation(),!1})})},pjax_complete:function(){this.init()}},archiveInit={init:function(){this.funcInit()},funcInit:function(){this.archiveEventInit(),this.commentInit(),this.fansFuncInit(),this.circleFuncInit(),this.repostFuncInit(),this.archAuthorTabShowInit(),this.archAuthorTabsClickInit(),this.iasInit(),this.echojsInit()},postRepostArticle:function(t,e,i,n,a,s){if(userId<0)return $.message({title:"提示",message:"请登录后操作",type:"error"}),!1;postArticle({title:indexInput.loginUserName+"转发了"+a.substring(0,20),text:'[repost href="'+t+'" bannerimg="'+i+'" repousername="'+n+'" repostext="'+a+"\" category='"+s+"']","fields[articleType]":"repost","fields[excerpt]":e,markdown:1,"category[]":1,visibility:"publish",allowComment:1,allowPing:1,allowFeed:1,do:"publish"},!1)},repostFuncInit:function(){var r=$("#repostComment");$(".share-btn").unbind("click").bind("click",function(t){$("#repostModal").modal("show"),$("#repostModal").on("shown.bs.modal",function(){r.focus()})}),$("#repostBtn").unbind("click").bind("click",function(t){var e=r.val(),i=r.data("posthref"),n=/src=[\'\"]?([^\'\"]*)[\'\"]?/i,a=$(".article-content").html().match(/<img.*?(?:>|\/>)/i),s="";a&&0<a.length&&((o=a[0].match(n))&&0<o.length&&(s=o[1]));a=s.match(n);a&&0<a.length&&(s=a[1]);var o=r.data("username"),n=r.data("excerpt"),a=r.data("category");"undefine"===n&&(n=""),archiveInit.postRepostArticle(i,e,s,o,n,a),$("#repostModal").modal("hide")}),$(".repost-row a").unbind("cilck").bind("click",function(t){var e=$(this).attr("href");$.pjax({url:e,container:"#pjax-container"}),t.stopPropagation()})},postFansArticle:function(i,n,a,s){$.post(gconf.oneaction,{type:"getfocusmid"},function(t){var e;t?(e=parseInt(t),postArticle({title:indexInput.loginUserName+"关注了圈友"+a,text:'[focususer href="'+i+'" avatar="'+n+'" username="'+a+'" sign="'+s+'" ]',"fields[articleType]":"focususer","fields[excerpt]":"关注了圈友"+a,markdown:1,"category[]":e,visibility:"publish",allowComment:1,allowPing:1,allowFeed:1,do:"publish"},!1)):console.log(t)})},fansFuncInit:function(){var t=$(".fan-event"),r=this;t.unbind("click").bind("click",function(t){var e,s,o;0<userId?(e=parseInt($(this).data("authorid")),s="关注"===$.trim($(this).text())?"follow":"unfollow",parseInt(userId)!==e?($(this).attr("disabled",!0),o=this,$.post("/",{followuser:1,follow:s,uid:userId,fid:e},function(t){var e,i,n,a;t&&("unfollow"===s?($(o).text("关注"),$(o).addClass("fans"),$(o).removeClass("fansed")):($(o).text("已关注"),$(o).addClass("fansed"),$(o).removeClass("fans"),Math.random()<=.3&&(a=$(o).attr("data-author_page")?(e=$(o).parent().siblings().data("authorhref"),i=$(".author-avatar").attr("src"),n=$(".author_page-name").text(),$(".author-sign").text()):(e=(a=$(o).parent().siblings()).attr("href"),i=a.children("img").attr("src"),n=a.children("div").children(".oDrAC").text(),a.children("div").children(".ezzhLs").text()),r.postFansArticle(e,i,n,a)))),$(o).attr("disabled",!1)})):$.message({title:"提示",message:"自己不能关注自己！",type:"warning"})):$.message({title:"提示",message:"没有登录！",type:"warning"})})},circleFuncInit:function(){$(".circle-event").unbind("click").bind("click",function(t){var e,i,n;0<userId?(e=parseInt($(this).data("categoryid")),i="加入"===$.trim($(this).text())?"follow":"unfollow",$(this).attr("disabled",!0),n=this,$.post("/",{followcircle:1,follow:i,uid:userId,mid:e},function(t){t&&("unfollow"===i?($(n).text("加入"),$(n).addClass("fans"),$(n).removeClass("fansed")):($(n).text("已加入"),$(n).addClass("fansed"),$(n).removeClass("fans"))),$(n).attr("disabled",!1)})):$.message({title:"提示",message:"没有登录！",type:"warning"})})},archAuthorTabShowInit:function(){var i=$(".react-tabs__tab-list"),n=i.find("li:first-child");0<i.length&&setTimeout(function(){var t=i.first().offset().left,e=n.first().offset().left-t,t=$(".line");t.css({transform:"translateX("+e+"px)"}),t.show()},100)},archiveLoadRebindInit:function(){archiveInit.fansFuncInit(),indexInput.articleClickInit(),archiveInit.echojsInit()},archAuthorTabsClickInit:function(){var a,s,t=$(".react-tabs__tab-list");0<t.length&&(a=t.first().offset().left,s=$(".line"),t.children().each(function(t,n){$(n).click(function(t){var e=$(n).data("tabindex");$(this).addClass("react-tabs__tab--selected").siblings().removeClass("react-tabs__tab--selected"),s.width($(n).width());var i=$(n).offset().left-a;s.css({transform:"translateX("+i+"px)"}),$.ajax({url:"?tabindex="+e,method:"get",success:function(t){var e=$.parseHTML(t);try{var i=$(".item-container",e);if(i.length<=0)return $.message({title:"通知",message:"服务器返回错误，请重试",type:"error"});i=i.html();$(".pagination",e).length<=0?$(".pagination").css("display","none"):$(".pagination").css("display","flex"),$(".item-container").html(i),archiveInit.archiveLoadRebindInit()}catch(t){console.log(t)}}})})}))},archiveEventInit:function(){$("#agree-btn").on("click",function(){$(this).get(0).disabled=!0,$(this).children().css("fill","rgb(228, 88, 62)"),$.ajax({url:gconf.index,type:"post",data:"agree="+$(this).attr("data-cid"),async:!0,timeout:3e4,cache:!1,success:function(t){/\d/.test(t)&&$(".agree-num").html(t)},error:function(){$(this).get(0).disabled=!1}})})},commentInit:function(){var e=$("html,body"),i=".comment-list",n=".comment-num",a=".comment-reply a",s="",o="";c();var r=$("#comment-form"),l=$(".submit.btn.comment-submit");function c(){$(a).click(function(){o=$(this).parent().parent().parent().attr("id")}),$("#cancel-comment-reply-link").click(function(){o=""})}l.unbind("click").bind("click",function(t){$(this).attr("disabled",!0),r.submit()}),r.submit(function(){var t=$(this).serializeArray();return""===$.trim(t[0].value)?($.message({title:"提示",message:"请输入内容",type:"error"}),l.attr("disabled",!1)):$.ajax({url:$(this).attr("action"),type:"post",data:$(this).serializeArray(),error:function(){return alert("提交失败，请检查网络并重试或者联系管理员。"),l.attr("disabled",!1),!1},success:function(t){if(l.attr("disabled",!1),!$(i,t).length)return alert("您输入的内容不符合规则或者回复太频繁，请修改内容或者稍等片刻。"),!1;s=$(i,t).html().match(/id=\"?comment-\d+/g).join().match(/\d+/g).sort(function(t,e){return t-e}).pop(),$(".page-navigator .prev").length&&""==o&&(s=""),o?(t=$("#comment-"+s,t).hide(),$("#"+o).find(".comment-children").length<=0&&$("#"+o).append("<div class='comment-children'><ol class='comment-list'></ol></div>"),s&&$("#"+o+" .comment-children .comment-list").prepend(t),o=""):(t=$("#comment-"+s,t).hide(),$(i).length||$(".comment-detail").prepend("<h6 class='comment-num'>0 条评论</h6><ol class='comment-list'></ol>"),$(i).prepend(t)),$("#comment-"+s).fadeIn(),$(n).length&&(t=parseInt($(n).text().match(/\d+/)),$(n).html($(n).html().replace(t,t+1))),TypechoComment.cancelReply(),$("#textarea").val(""),$(a+", #cancel-comment-reply-link").unbind("click"),c(),s?e.animate({scrollTop:$("#comment-"+s).offset().top-50},300):e.animate({scrollTop:$("#comments").offset().top-50},300)}}),!1})},echojsInit:function(){echo.init({offset:100,throttle:250,callback:function(t,e){}})},iasInit:function(){var n=$(".a-pageLink .next");0<n.length||n.attr("style","display:none"),n.unbind("click").bind("click",function(){var t=$(this).attr("href"),i=$(".a-pageLink .donut");return void 0!==t&&$.ajax({url:t,type:"get",beforeSend:function(){n.hide(),i.fadeIn()},error:function(t){},success:function(t){var e=$(t).find(".post-article");i.hide(),$(".list").append(e).fadeIn();t=$(t).find(".a-pageLink .next").attr("href");void 0!==t?(n.attr("href",t),n.fadeIn()):(n.attr("style","display:none"),$(".a-pageLink").append('<a href="javascript:;" rel="nofollow">加载完毕</a>')),archiveInit.archiveLoadRebindInit()}}),!1})},pjax_complete:function(){this.archiveEventInit(),this.commentInit(),this.repostFuncInit(),this.archAuthorTabShowInit(),this.iasInit(),this.echojsInit()}},recommendInit={init:function(){this.autoDirayWith()},autoDirayWith:function(t){for(var e=document.getElementsByClassName("circle-diary-bg"),i=0;i<e.length;i++)e[i].style.height=e[i].offsetWidth+"px"},pjax_complete:function(){this.autoDirayWith()}},tagsManageInit={init:function(){this.circleEditBtn()},circleEditBtn:function(){var t=$(".circle-item .edit-btn button"),e=$("#circle-edit-save"),i=-1;t.unbind("click").bind("click",function(t){i=parseInt($(this).data("categoryid"));var e=$(this).data("name");$("#selectCircle").val(e),$("#changeCatagModal").modal("show")}),e.unbind("click").bind("click",function(t){var e;0<!i||(e=$("#changeCircle").val(),$.ajax({url:gconf.index,data:{changeCircleCat:1,mid:i,changetomid:e},method:"POST",success:function(t){"success"===t&&$.message({title:"通知",message:"更改成功，刷新后可见",type:"info"}),$("#changeCatagModal").modal("hide")},error:function(t){console.log(t),$("#changeCatagModal").modal("hide")}}))})},pjax_complete:function(){this.circleEditBtn()}};$(function(){$(window).unbind("scroll").bind("scroll",function(){var t=$(window).scrollTop(),e=$(".back-to-top");400<t?(e.addClass("animate__fadeInDown"),e.css("display","block")):e.css("display","none")}),$(".back-to-top").unbind("click").bind("click",function(){$("body,html").animate({scrollTop:0},600)}),indexInput.init(),tagsManageInit.init(),recommendInit.init(),archiveInit.init()});var pjaxInit=function(){indexInput.pjax_complete(),archiveInit.init(),recommendInit.pjax_complete(),owoInit(),tagsManageInit.pjax_complete()};function postArticle(e,i){$.post(gconf.oneaction,{type:"getsecuritytoken"},function(t){return t.code?$.ajax({url:gconf.index+"/action/contents-post-edit?do=publish&_="+t.data,type:"post",data:e,success:function(t){i&&setTimeout(function(){$.pjax.reload("#pjax-container",{container:"#pjax-container",fragment:"#pjax-container",timeout:8e3}),$.message({title:"提示",message:"发布成功，没出来的话就刷新一下吧",type:"success"})},800)},error:function(t){return $.message({title:"提示",message:"code:"+t.status+"err:"+t.responseText+t,type:"error"})}}):$.message({title:"提示",message:"请检查插件是否正确安装！",type:"error"}),!1})}function submitForm(t){var e=$(t);e.val("发送中...");var i=$("#post-title"),n=$("#text").val(),t=new Date,t=t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate();if(0<n.length&&""!==n&&i.val(n.substring(0,25)),"default"===indexInput.nowtype)0!==n.length&&""!==n||i.val("图文小记事~"+t),1===indexInput.additionArray.length?(n+="\n\n",indexInput.additionArray.forEach(function(t){n=n+"![]("+t+")"}),n+="\n\n"):1<indexInput.additionArray.length&&(n+="\n[gallery]",indexInput.additionArray.forEach(function(t){n=n+"![]("+t+")"}),n+="[endgallery]\n");else if("link"===indexInput.nowtype){if(!(0<indexInput.additionArray.length))return $.message({title:"提示",message:"请输入正确链接",type:"warning"}),e.val("发送"),!1;0<indexInput.additionArray[1].length&&""!==indexInput.additionArray[1]?i.val(indexInput.additionArray[1].substring(0,15)):i.val("分享一个链接~"+t),n=n?'[pureLink comment="'+n+'..." text="'+indexInput.additionArray[1]+'" link="'+indexInput.additionArray[0]+'"]':'[pureLink comment="'+indexInput.additionArray[1].substring(0,60)+'..." text="'+indexInput.additionArray[1]+'" link="'+indexInput.additionArray[0]+'"]'}else if("video"===indexInput.nowtype){if(!(0<indexInput.additionArray.length))return $.message({title:"提示",message:"请输入正确链接",type:"warning"}),e.val("发送"),!1;0!==n.length&&""!==n||i.val("分享视频~"+t),indexInput.additionArray.forEach(function(t){n=n+'\n[video src="'+t+'"]\n'})}else if("bilibili"===indexInput.nowtype){if(!(0<indexInput.additionArray.length))return $.message({title:"提示",message:"请输入正确链接",type:"warning"}),e.val("发送"),!1;0!==n.length&&""!==n||i.val("分享bilibili视频~"+t),indexInput.additionArray.forEach(function(t){n=n+'\n[bilibili bv="'+t+'" p="1"]\n'})}if(0===n.length||""===n)return $.message({title:"提示",message:"要不输入点东西吧~",type:"warning"}),e.val("发送"),!1;var a=!1,s=$("#category").val();return"undefined"==typeof allCategories?$.message({title:"提示",message:"还没有创建圈子",type:"error"}):(allCategories.forEach(function(t){t[1]===s&&(a=!0)}),!1===a&&(s=allCategories[0][1]),postArticle({title:i.val(),text:n,"fields[articleType]":indexInput.nowtype,markdown:1,"category[]":s,visibility:"publish",allowComment:1,allowPing:1,allowFeed:1,do:"publish"},!0)),!1}function del_article(t,e){t=$(t).attr("href");return!0===confirm("您真的确定要删除吗？")&&$.ajax({url:t,method:"post",success:function(t){$.message({title:"提示",message:"删除成功！",type:"info"})},error:function(t){$.message({title:"提示",message:"删除成功！",type:"info"})}}),!1}function videoToggle(t,e,i){return $(e).hasClass("video-slim")?($(e).children().children("span:first-child").html('<svg class="bi bi-arrows-angle-contract" width=".7em" height=".7em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" d="M9.5 2.036a.5.5 0 0 1 .5.5v3.5h3.5a.5.5 0 0 1 0 1h-4a.5.5 0 0 1-.5-.5v-4a.5.5 0 0 1 .5-.5z"/>\n  <path fill-rule="evenodd" d="M14.354 1.646a.5.5 0 0 1 0 .708l-4.5 4.5a.5.5 0 1 1-.708-.708l4.5-4.5a.5.5 0 0 1 .708 0zm-7.5 7.5a.5.5 0 0 1 0 .708l-4.5 4.5a.5.5 0 0 1-.708-.708l4.5-4.5a.5.5 0 0 1 .708 0z"/>\n  <path fill-rule="evenodd" d="M2.036 9.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-1 0V10h-3.5a.5.5 0 0 1-.5-.5z"/>\n</svg>'),$(e).children().children("span:last-child").text("收缩"),$(e).removeClass("video-slim")):($(e).children().children("span:first-child").html('<svg width=".7em" height=".7em" viewBox="0 0 16 16" class="bi bi-arrows-angle-expand" fill="currentColor" xmlns="http://www.w3.org/2000/svg">\n<path fill-rule="evenodd" d="M5.828 10.172a.5.5 0 0 0-.707 0l-4.096 4.096V11.5a.5.5 0 0 0-1 0v3.975a.5.5 0 0 0 .5.5H4.5a.5.5 0 0 0 0-1H1.732l4.096-4.096a.5.5 0 0 0 0-.707zm4.344-4.344a.5.5 0 0 0 .707 0l4.096-4.096V4.5a.5.5 0 1 0 1 0V.525a.5.5 0 0 0-.5-.5H11.5a.5.5 0 0 0 0 1h2.768l-4.096 4.096a.5.5 0 0 0 0 .707z"/>\n</svg>'),$(e).children().children("span:last-child").text("展开"),$(e).addClass("video-slim")),$(t).collapse("toggle"),i.stopPropagation(),!1}function checkURL(t){return!0===new RegExp(/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[\-;:&=\+\$,\w]+@)?[A-Za-z0-9\.\-]+|(?:www\.|[\-;:&=\+\$,\w]+@)[A-Za-z0-9\.\-]+)((?:\/[\+~%\/\.\w\-_]*)?\??(?:[\-\+=&;%@\.\w_]*)#?(?:[\.\!\/\\\w]*))?)/).test(t)}